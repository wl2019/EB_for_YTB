2019-02-07 21:20:15--登录--SQL=select user_pwd,user_id,USER_APP,USER_NAME,USER_STAT from sys_users where user_login='test',Err=Mysql.ReadData ErrMsg=Fatal error encountered during command execution.
2019-02-18 21:18:53--查询开卡汇总--SQL=select A1 as '开卡人',A2 as '开卡时间',A3 as '类型',A4 as '持卡人',A5 as '卡号',A6 as '卡类',if (A7 = '-','-',(if (A7 = 'BGN','正常','停用'))) as '卡状态',format(A8 / 100, 2) as '收费金额(元)'  from ( select b.USER_NAME as A1,a.oper_time as A2,'买方' as A3,a.user_name as A4,user_card as A5,if(card_type=1,'主卡','副卡') as A6,card_flag as A7,Chg_Val as A8 from base_ucard a ,sys_users b, rec_user c where a.ADD_ID = b.USER_ID and a.user_card = c.Card_No and c.Oper_Type = 'ISSU' and a.oper_time>='2019-02-11 08:00:00' and a.oper_time<='2019-02-16  07:59:59'   union select b.USER_NAME as A1,a.ADD_DT as A2,'卖方' as A3,a.STORE_PERSON as A4,STORE_CARD as A5,if (card_type = 3,'结算卡',(if (card_type = 1,'第一副卡','副卡'))) as A6,CARD_STAT as A7,Chg_Val as A8 from mng_card a,sys_users b, rec_firm c where a.ADD_ID = b.USER_ID and a.STORE_CARD = c.Card_No and c.Oper_Type = 'ISSU' and a.ADD_DT>='2019-02-11 08:00:00' and a.ADD_DT<='2019-02-16  07:59:59'   and a.user_name like '%%'  union (select A1,'-','-','小计',count(A2),'-','-',sum(A8)  from ( select b.USER_NAME as A1,a.oper_time as A2,'买方' as A3,a.user_name as A4,user_card as A5,card_type as A6,card_flag as A7,Chg_Val as A8 from base_ucard a ,sys_users b, rec_user c where a.ADD_ID = b.USER_ID and a.user_card = c.Card_No and c.Oper_Type = 'ISSU' and a.oper_time>='2019-02-11 08:00:00' and a.oper_time<='2019-02-16  07:59:59'   and a.user_name like '%%'  )M group by A1)  union (select '-','-','-','合计',count(A2),'-','-',sum(A8)  from ( select b.USER_NAME as A1,a.oper_time as A2,'买方' as A3,a.user_name as A4,user_card as A5,card_type as A6,card_flag as A7,Chg_Val as A8 from base_ucard a ,sys_users b, rec_user c where a.ADD_ID = b.USER_ID and a.user_card = c.Card_No and c.Oper_Type = 'ISSU' and a.oper_time>='2019-02-11 08:00:00' and a.oper_time<='2019-02-16  07:59:59'   and a.user_name like '%%'  )N ) ) Z order by Z.A1 desc, Z.A2 desc,Err=Mysql.ReadData ErrMsg=Unknown column 'a.user_name' in 'where clause'
2019-02-18 21:19:13--查询开卡汇总--SQL=select A1 as '开卡人',A2 as '开卡时间',A3 as '类型',A4 as '持卡人',A5 as '卡号',A6 as '卡类',if (A7 = '-','-',(if (A7 = 'BGN','正常','停用'))) as '卡状态',format(A8 / 100, 2) as '收费金额(元)'  from ( select b.USER_NAME as A1,a.oper_time as A2,'买方' as A3,a.user_name as A4,user_card as A5,if(card_type=1,'主卡','副卡') as A6,card_flag as A7,Chg_Val as A8 from base_ucard a ,sys_users b, rec_user c where a.ADD_ID = b.USER_ID and a.user_card = c.Card_No and c.Oper_Type = 'ISSU' and a.oper_time>='2019-02-11 08:00:00' and a.oper_time<='2019-02-16  07:59:59'   union select b.USER_NAME as A1,a.ADD_DT as A2,'卖方' as A3,a.STORE_PERSON as A4,STORE_CARD as A5,if (card_type = 3,'结算卡',(if (card_type = 1,'第一副卡','副卡'))) as A6,CARD_STAT as A7,Chg_Val as A8 from mng_card a,sys_users b, rec_firm c where a.ADD_ID = b.USER_ID and a.STORE_CARD = c.Card_No and c.Oper_Type = 'ISSU' and a.ADD_DT>='2019-02-11 08:00:00' and a.ADD_DT<='2019-02-16  07:59:59'   and a.user_name like '%陈%'  union (select A1,'-','-','小计',count(A2),'-','-',sum(A8)  from ( select b.USER_NAME as A1,a.oper_time as A2,'买方' as A3,a.user_name as A4,user_card as A5,card_type as A6,card_flag as A7,Chg_Val as A8 from base_ucard a ,sys_users b, rec_user c where a.ADD_ID = b.USER_ID and a.user_card = c.Card_No and c.Oper_Type = 'ISSU' and a.oper_time>='2019-02-11 08:00:00' and a.oper_time<='2019-02-16  07:59:59'   and a.user_name like '%陈%'  )M group by A1)  union (select '-','-','-','合计',count(A2),'-','-',sum(A8)  from ( select b.USER_NAME as A1,a.oper_time as A2,'买方' as A3,a.user_name as A4,user_card as A5,card_type as A6,card_flag as A7,Chg_Val as A8 from base_ucard a ,sys_users b, rec_user c where a.ADD_ID = b.USER_ID and a.user_card = c.Card_No and c.Oper_Type = 'ISSU' and a.oper_time>='2019-02-11 08:00:00' and a.oper_time<='2019-02-16  07:59:59'   and a.user_name like '%陈%'  )N ) ) Z order by Z.A1 desc, Z.A2 desc,Err=Mysql.ReadData ErrMsg=Unknown column 'a.user_name' in 'where clause'
